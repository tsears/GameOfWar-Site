var War=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(1),a=r(i),u=n(2),o=r(u),s=n(7),f=r(s),c=n(5),l=r(c);e.exports={War:a.default,Game:o.default,EndlessGame:f.default,Deck:l.default}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),o=r(u),s=n(5),f=r(s),c=function(){function e(t,n,r){i(this,e),this._numSuits=t,this._numRanks=n,this._numPlayers=r,this._warGame=new o.default(new f.default(this._numSuits,this._numRanks),this._numPlayers)}return a(e,[{key:"game",get:function(){return this._warGame}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CardAwardMethod=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(3),o=r(u),s=n(4),f=r(s),c=n(5),l=r(c),d=t.CardAwardMethod={Increasing:0,Shuffled:1},h=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.Increasing;if(i(this,e),this._deck=t,this._numPlayers=n,this._players=[],this._playerCount=0,this._distributionMethod=r,t.currentSize<n)throw new Error("Deck must at least the same size as the number of players");for(var a=1;a<=n;++a)this._players.push(new o.default("Player "+a)),++this._playerCount;this._startGame()}return a(e,[{key:"getPlayer",value:function(e){var t=e-1;return this._players[t]}},{key:"playRound",value:function(){var e=new f.default,t=this._players.map(function(e,t){return t});return this._resolveRound(t,e)}},{key:"_startGame",value:function(){this._distributeCards()}},{key:"_resolveRound",value:function(e,t){var n=this._draw(e,t),r=this._findCardWithMaxValue(n),i=n.filter(function(e){return e&&e.rank===r.rank}).length>1;if(i){t.war=!0;var a=this._getWarringPlayerIndicies(n,e,r);return this._prepForWar(n,a,t),this._resolveRound(a,t)}var u=this._players[e[n.indexOf(r)]];return this._finishRound(u,n,t)}},{key:"_prepForWar",value:function(e,t,n){this._draw(t,n)}},{key:"_finishRound",value:function(e,t,n){return e?(n.winner=e,this._awardCards(n.draws,e)):n.winner=null,this._gameIsOver()&&(n.gameOver=!0),n}},{key:"_draw",value:function(e,t){for(var n=this,r=e.map(function(e){return n._players[e].revealCard()}),i=0;i<e.length;++i){var a=e[i];t.draws[a]||(t.draws[a]=[]),t.draws[a].push(r[i])}return r}},{key:"_gameIsOver",value:function(){return this._players.filter(function(e){return 0===e.cardCount}).length===this._numPlayers-1}},{key:"_getWarringPlayerIndicies",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++)e[i]&&e[i].rank===n.rank&&r.push(t[i]);return r}},{key:"_findCardWithMaxValue",value:function(e){return e.filter(function(e){return e}).reduce(function(e,t){return t.rank>e.rank?t:e},{rank:0})}},{key:"_awardCards",value:function(e,t){this._distributionMethod===d.Increasing?this._awardCardsIncreasing(e,t):this._distributionMethod===d.Shuffled&&this._awardCardsShuffled(e,t)}},{key:"_awardCardsIncreasing",value:function(e,t){this._getDrawsThen(e,function(e){t.awardCard(e)})}},{key:"_awardCardsShuffled",value:function(e,t){var n=new l.default(0,0);for(this._getDrawsThen(e,function(e){n.add(e)}),n.shuffle();n.currentSize>0;)t.awardCard(n.deal())}},{key:"_getDrawsThen",value:function(e,t){for(var n=[],r=0;r<e.length;++r)for(var i=0;i<e[r].length;++i)e[r][i]&&t(e[r][i]);return n}},{key:"_distributeCards",value:function(){this._deck.shuffle();for(var e=Math.floor(this._deck.currentSize/this._numPlayers);e>0;){for(var t=0;t<this._numPlayers;++t)this._players[t].addCard(this._deck.deal());--e}}},{key:"deck",get:function(){return this._deck}},{key:"playerCount",get:function(){return this._playerCount}}]),e}();t.default=h},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this._name=t,this._cards=[]}return r(e,[{key:"addCard",value:function(e){this._cards.push(e)}},{key:"awardCard",value:function(e){this._cards.unshift(e)}},{key:"revealCard",value:function(){return this._cards.pop()}},{key:"cardCount",get:function(){return this._cards.length}},{key:"score",get:function(){return this._cards.length}},{key:"name",get:function(){return this._name}}]),e}();t.default=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e),this._draws=[],this._war=!1,this._winner=null,this._gameOver=!1}return r(e,[{key:"draws",get:function(){return this._draws}},{key:"war",get:function(){return this._war},set:function(e){this._war=e}},{key:"winner",get:function(){return this._winner},set:function(e){this._winner=e}},{key:"gameOver",get:function(){return this._gameOver},set:function(e){this._gameOver=e}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),o=r(u),s=function(){function e(t,n){i(this,e),this._numSuits=t,this._numRanks=n,this._cards=[],this._initialSize=0;for(var r=1;r<=t;++r)for(var a=1;a<=n;++a)++this._initialSize,this._cards.push(new o.default(r,a))}return a(e,[{key:"deal",value:function(){return this._cards.pop()}},{key:"add",value:function(e){return this._cards.push(e)}},{key:"shuffle",value:function(){var e=[],t=this._cards.slice();do{var n=Math.floor(Math.random()*t.length),r=t.splice(n,1)[0];e.push(r)}while(t.length>0);this._cards=e}},{key:"numSuits",get:function(){return this._numSuits}},{key:"numRanks",get:function(){return this._numRanks}},{key:"currentSize",get:function(){return this._cards.length}},{key:"initialSize",get:function(){return this._initialSize}}]),e}();t.default=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){n(this,e),this._suit=t,this._rank=r}return r(e,[{key:"suit",get:function(){return this._suit}},{key:"rank",get:function(){return this._rank}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var u=i.get;if(void 0!==u)return u.call(r)},f=n(3),c=(r(f),n(4)),l=(r(c),n(5)),d=r(l),h=n(2),_=r(h),y=function(e){function t(e,n){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return u(t,e),o(t,[{key:"_startGame",value:function(){this._discardPile=new d.default(0,0),this._distributeCards()}},{key:"_prepForWar",value:function(e){this._discardDraw(e),this._playersNeedCards()&&this._distributeCards()}},{key:"_finishRound",value:function(e,t,n){return n.winner=e,this._discardDraw(t),this._playersNeedCards()&&this._distributeCards(),n}},{key:"_discardDraw",value:function(e){for(var t=0;t<e.length;++t)this._discardPile.add(e[t]);e=null}},{key:"_playersNeedCards",value:function(){return this._players.filter(function(e){return 0===e.cardCount}).length>0}},{key:"_distributeCards",value:function(){for(var e=this._discardPile.currentSize,n=0;n<e;++n){var r=this._discardPile.deal();this._deck.add(r)}s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_distributeCards",this).call(this)}},{key:"discardPile",get:function(){return this._discardPile}}]),t}(_.default);t.default=y}]);
